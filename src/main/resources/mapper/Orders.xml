<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lanou.dao.OrdersMapper">


    <resultMap type="Orders" id="OrdersResult">
        <id column="OrderId" property="OrderId" jdbcType="INTEGER"/>
        <result column="OrderPay" property="OrderPay" jdbcType="VARCHAR"/>
        <result column="OrderAllMoney" property="OrderAllMoney" jdbcType="DOUBLE"/>
        <result column="UserId" property="UserId" jdbcType="INTEGER"/>
        <result column="OrderTicket" property="OrderTicket" jdbcType="VARCHAR"/>
        <result column="OrderText" property="OrderText" jdbcType="VARCHAR"/>
        <result column="OrderScore" property="OrderScore" jdbcType="INTEGER"/>
        <result column="OrderYunfei" property="OrderYunfei" jdbcType="DOUBLE"/>
        <result column="YesOrNo" property="YesOrNo" jdbcType="INTEGER"/>
        <result column="Adress_id" property="Adress_id" jdbcType="INTEGER"/>
        <result column="GouwuCishu" property="GouwuCishu" jdbcType="INTEGER"/>
        <result column="ShifouZhifu" property="ShifouZhifu" jdbcType="INTEGER"/>
    </resultMap>
    <resultMap type="WuliuAdress" id="shouhuorenResult">
        <id column="xId" property="xId" jdbcType="INTEGER"/>
        <result column="ShouhuoName" property="ShouhuoName" jdbcType="VARCHAR"/>
        <result column="ShouhuoAdress" property="ShouhuoAdress" jdbcType="VARCHAR"/>
        <result column="XiangxiAdress" property="XiangxiAdress" jdbcType="VARCHAR"/>
        <result column="ShouhuoPhone" property="ShouhuoPhone" jdbcType="VARCHAR"/>
        <result column="user_id" property="user_id" jdbcType="INTEGER"/>
    </resultMap>
    <resultMap type="OrderAndWine" id="orderAndWineResult">
        <id column="order_id" property="order_id" jdbcType="INTEGER"/>
        <result column="wine_id" property="wine_id" jdbcType="INTEGER"/>
        <result column="wine_count" property="wine_count" jdbcType="INTEGER"/>
    </resultMap>

    <select id="findOrders" parameterType="Integer" resultMap="OrdersResult">
        select * from zhongjiu_order WHERE user_id = #{user_id} and ShifouZhifu = 1;
	</select>
    <update id="tijiaoDingdan">
        update zhongjiu_car set YesOrNo = 1 where user_id = #{user_id};
    </update>
    <select id="findOrdersId" parameterType="Integer" resultMap="OrdersResult">
        select OrderId from zhongjiu_order WHERE user_id = #{user_id} and tijiaoDingdan = 1;
    </select>
    <update id="GouwuCishu" parameterType="Orders">
        update zhongjiu_car set GouwuCishu = 1 where user_id = #{user_id} and ShifouZhifu = 1;
    </update>
    <update id="ShifouZhifu">
        update zhongjiu_car set ShifouZhifu = 1 where user_id = #{user_id};
    </update>

    <select id="findWuliu" parameterType="Integer" resultMap="shouhuorenResult">
        select * from zhongjiu_order_shouhuoren where user_id = #{user_id};
	</select>

    <insert id="insertOrders" parameterType="Orders" keyProperty="OrderId" useGeneratedKeys="true">
        insert into zhongjiu_order (OrderPay,OrderAllMoney,UserId,OrderTicket,OrderText,OrderScore,OrderYunfei) values (#{OrderPay},#{OrderAllMoney},#{UserId},#{OrderTicket},#{OrderText},#{OrderScore},#{OrderYunfei});
    </insert>

    <insert id="insertWine" parameterType="OrderAndWine">
            insert into zhongjiu_order_wine (order_id,wine_id,wine_count) values (#{order_id},#{wine_id},#{wine_count});
    </insert>
    <select id="findWines" parameterType="Integer" resultMap="orderAndWineResult">
        select wine_id from zhongjiu_order_wine WHERE order_id = #{order_id};;
    </select>

    <insert id="insertAdress" parameterType="WuliuAdress">
        insert into zhongjiu_order_shouhuoren (ShouhuoName,ShouhuoAdress,XiangxiAdress,ShouhuoPhone,user_id)
        values (#{ShouhuoName},#{ShouhuoAdress},#{XiangxiAdress},#{ShouhuoPhone},#{user_id});
    </insert>
</mapper>